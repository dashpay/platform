<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Proof Result</title>
</head>
<body>
    <h1>Proof Result Test</h1>
    <pre id="output"></pre>
    
    <script type="module">
        import init, { WasmSdkBuilder, get_identity_nonce_with_proof_info } from './pkg/wasm_sdk.js';
        
        const output = document.getElementById('output');
        
        async function test() {
            await init();
            
            const builder = WasmSdkBuilder.testnet();
            const sdk = builder.with_cache(false).build();
            
            const identity_id = "5DbLwAxGBzUzo81VewMUwn4b5P4bpv9FNFybi25XB5Bk";
            
            output.textContent = "Testing identity: " + identity_id + "\n\n";
            
            try {
                output.textContent += "Fetching nonce with proof info...\n";
                const result = await get_identity_nonce_with_proof_info(sdk, identity_id);
                
                output.textContent += "\nRaw result type: " + typeof result + "\n";
                output.textContent += "Result constructor: " + result.constructor.name + "\n";
                output.textContent += "\nRaw result value:\n" + JSON.stringify(result, null, 2) + "\n";
                
                // Check if it's a special object
                if (result && typeof result === 'object') {
                    output.textContent += "\nObject keys: " + Object.keys(result).join(", ") + "\n";
                    output.textContent += "Object entries:\n";
                    for (const [key, value] of Object.entries(result)) {
                        output.textContent += `  ${key}: ${typeof value} = ${JSON.stringify(value)}\n`;
                    }
                }
                
                // Try to access specific fields
                if (result) {
                    output.textContent += "\nTrying to access fields:\n";
                    output.textContent += "result.data = " + JSON.stringify(result.data) + "\n";
                    output.textContent += "result.metadata = " + JSON.stringify(result.metadata) + "\n";
                    output.textContent += "result.proof = " + JSON.stringify(result.proof) + "\n";
                }
            } catch (e) {
                output.textContent += "Error: " + e.message + "\n";
                output.textContent += "Stack: " + e.stack + "\n";
            }
        }
        
        test().catch(console.error);
    </script>
</body>
</html>